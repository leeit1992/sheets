!function(e){"use strict";new(Backbone.View.extend({el:"#op-page-handle-massages",formClassError:"md-input-danger",events:{"submit #op-form-messages":"handleForm","click .op-massages-rm-js":"removeMessage","click .op-remove-all-mes":"removeAllMessage","click .op-check-message":"checkInbox","click .op-massage-forward":"getDataForward","change .op-mes-search, .op-mes-filter-by-user, .op-mes-filter-by-date":"filterMessages"},noticeTpl:_.template('<div class="uk-notify-message <%= classes %>">\t\t\t\t\t\t\t\t        <a class="uk-close"></a>\t\t\t\t\t\t\t\t        <div>\t\t\t\t\t\t\t\t           <%= message %>\t\t\t\t\t\t\t\t        </div>\t\t\t\t\t\t\t\t    </div>'),initialize:function(){var t=e("#mailbox");e("#mailbox_select_all").on("ifChanged",function(){var a=e(this);t.find("[data-md-icheck]").each(function(){e(this).iCheck(a.is(":checked")?"check":"uncheck")})})},handleForm:function(){var t=this,a={formData:e("#op-form-messages",this.el).serialize()};return altair_helpers.content_preloader_show(),e.ajax({url:OPDATA.adminUrl+"/write-messages",type:"POST",data:a,success:function(a){altair_helpers.content_preloader_hide(),e(".uk-close").trigger("click");var s=t.noticeTpl({message:"Send messages success.",classes:"uk-notify-message-success"});e(".op-notify-js",t.el).html(s).show(),setTimeout(function(){e(".op-notify-js",t.el).fadeOut()},2e3)}}),!1},removeMessage:function(t){var a=e(t.currentTarget).attr("data-id"),s=e(t.currentTarget).attr("data-rm"),r=e(".op-mes-item-"+a);e.ajax({url:OPDATA.adminUrl+"/delete-messages",type:"POST",data:{id:a,type:s},success:function(e){r.remove(),UIkit.modal.alert("Delete Success!")}})},removeAllMessage:function(t){var a=new Array,s=e(t.currentTarget).attr("data-rm"),r=e(t.currentTarget).closest("li");e(".op-message-check",this.el).each(function(t,s){s.checked&&a.push(e(s).val())}),e.ajax({url:OPDATA.adminUrl+"/delete-messages",type:"POST",data:{id:a,type:s},success:function(t){e(r).remove(),e.each(a,function(t,a){e(".op-mes-item-"+a).remove()}),UIkit.modal.alert("Delete Success!")}})},filterMessages:function(t){var a=this,s=e(t.currentTarget).val(),r=e(t.currentTarget).attr("data-type"),c=e(t.currentTarget).attr("data-type-mes");0<s.length?(e(".op-list-current",this.el).fadeOut(),e(".op-list-result",this.el).fadeIn(),altair_helpers.content_preloader_show()):(e(".op-list-result",this.el).fadeIn(),e(".op-list-current",this.el).fadeOut(),altair_helpers.content_preloader_hide()),e.ajax({url:OPDATA.adminUrl+"/filter-messages",type:"GET",data:{value:e(t.currentTarget).val(),type:r,typeMes:c},success:function(t){var s=JSON.parse(t);e(".op-list-result",a.el).html(s.data),altair_form_adv.masked_inputs(),altair_helpers.content_preloader_hide()}})},checkInbox:function(t){var a=e(t.currentTarget).attr("data-id");e.ajax({url:OPDATA.adminUrl+"/update-inbox",type:"POST",data:{id:a},success:function(e){}})},getDataForward:function(t){var a=e(t.currentTarget).attr("data-id"),s=e(".op-data-mes-"+a).val();s=JSON.parse(s),console.log(s)}}))}(jQuery);